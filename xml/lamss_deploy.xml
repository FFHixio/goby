<?xml version="1.0" encoding="UTF-8"?>
<!-- contains nafcon (plus) commands: deploy, prosecute 
 for replacing pFramer (but still need pNaFCon) --> 
<message_set>
  <message>
    <name>LAMSS_DEPLOY</name>
    <trigger>publish</trigger> <!-- package upon publish to some moos var -->
    <trigger_moos_var mandatory_content="MessageType=LAMSS_DEPLOY">
      OUTGOING_COMMAND
    </trigger_moos_var>
    <size>32</size>
    <header>
      <id>18</id>
      <time>
        <name>Timestamp</name>
      </time>
      <src_id>
        <name>SourcePlatformId</name>
      </src_id>
      <dest_id>
        <name>DestinationPlatformId</name>
      </dest_id>
    </header>
    <layout>
      <static>
        <name>MessageType</name>
        <value>LAMSS_DEPLOY</value>
      </static>
      <enum>
        <name>Deploy_Mode</name>
	<value>LOITER</value>
	<value>RETURN</value>
	<value>RACETRACK</value>
	<value>ZIGZAG</value>
	<value>BISTATIC</value>
	<value>TRAIL</value>
        <value>BISTATIC_RATE</value>
      </enum>
      <enum>
        <name>Depth_Mode</name>
	<value>SINGLE</value>
	<value>DUAL</value>
	<value>YOYO</value>
	<value>ADAPTIVE_YOYO</value>
	<value>ADAPTIVE_SINGLE</value>
	<value>ADAPTIVE_ACOMMS</value>
      </enum>
      <!-- added in SWAMSI 09 -->
      <enum>
        <name>Sonar_Control</name>
        <value>ON</value>
        <value>OFF</value>
      </enum>
      <!-- added in SWAMSI 11 -->
      <enum>
        <name>Sonar_Process</name>
        <value>ON</value>
        <value>OFF</value>
      </enum>
      <!-- end added in SWAMSI 09 -->
      <float>
        <name>Deploy_Duration</name>
        <max>604800</max>
        <min>0</min>
        <precision>-1</precision>
      </float>
      <float>
        <name>Deploy_X</name>
        <precision>0</precision>
        <max>100000</max>
        <min>-100000</min>
      </float>
      <float>
        <name>Deploy_Y</name>
        <precision>0</precision>
        <max>100000</max>
        <min>-100000</min>
      </float>
      <float>
        <name>Deploy_Speed</name>
        <precision>1</precision>
        <max>2.0</max>
        <min>0</min>
      </float>
      <int>
        <name>Deploy_Depth</name>
        <max>6400</max>
        <min>0</min>
      </int>
      <int>
        <name>Alternate_Depth</name>
        <max>6400</max>
        <min>0</min>
      </int>
      <int>
        <name>Operation_Radius</name>
        <max>262000</max>
        <min>0</min>
      </int>
      <float>
        <name>Radius_Period</name>
        <max>1023</max>
        <min>0</min>
        <precision>0</precision>
      </float>
      <int>
        <name>Segments</name>
        <max>31</max>
        <min>0</min>
      </int>
      <float algorithm="angle_0_360">
        <name>Survey_Heading</name>
        <max>360</max>
        <min>0</min>
        <precision>0</precision>
      </float>
      <float>
        <name>Survey_Length</name>
        <max>4095</max>
        <min>0</min>
        <precision>0</precision>
      </float>
      <float>
        <name>Survey_Width</name>
        <max>4095</max>
        <min>0</min>
        <precision>0</precision>
      </float>
      <bool>
        <name>Clockwise</name>
      </bool>
      <enum>
        <name>Trail_Contact</name>
        <value>leonardo</value>
        <value>alliance</value>
        <value>oex_groucho</value>
        <value>oex_harpo</value>
        <value>unicorn</value>
        <value>macrura</value>
      </enum>
      <float>
        <name>Trail_Range</name>
        <max>1023</max>
        <min>0</min>
        <precision>0</precision>
      </float>
      <float algorithm="angle_0_360">
        <name>Trail_Angle</name>
        <max>359</max>
        <min>0</min>
        <precision>0</precision>
      </float>
      <enum>
        <name>Trail_Angle_Type</name>
        <value>relative</value>
        <value>absolute</value>
      </enum>
      <float>
        <name>GPS_Interval</name>
        <max>4095</max>
        <min>256</min>
        <precision>0</precision>
      </float>
    </layout>
    <!-- decoding -->
    <on_receipt>        
      <publish>
        <moos_var>INCOMING_COMMAND</moos_var>
        <all />
      </publish>
      <!-- added in SWAMSI 09 -->
      <publish>
        <moos_var>SONAR_CONTROL</moos_var>
        <message_var>Sonar_Control</message_var>
      </publish>
     <!-- added in SWAMSI 11 -->
      <publish>
        <moos_var>SONAR_PROCESS</moos_var>
        <message_var>Sonar_Process</message_var>
      </publish>
      <publish>
        <moos_var>DEPLOY_STATION</moos_var>
        <format>points=%1%,%2%</format>
        <message_var>Deploy_X</message_var>
        <message_var>Deploy_Y</message_var>
      </publish>
      <publish>
        <moos_var type="double">DEPLOY_RADIUS</moos_var>
        <message_var>Operation_Radius</message_var>
      </publish>
      <publish>
        <moos_var type="double">DEPLOY_DURATION</moos_var>
        <message_var>Deploy_Duration</message_var>
      </publish>
      <publish>
        <moos_var>ORBIT_RADIUS</moos_var>
        <message_var>Radius_Period</message_var>
      </publish>
      <publish>
        <moos_var>SENSOR_DEPLOY</moos_var>
        <format>polygon=radial:%1%,%2%,%3%,%4%#clockwise=%5%#speed=%6%</format>
        <message_var>Deploy_X</message_var>
        <message_var>Deploy_Y</message_var>
        <message_var>Radius_Period</message_var>
        <message_var>Segments</message_var>
        <message_var>Clockwise</message_var>
        <message_var>Deploy_Speed</message_var>
      </publish>
      <publish>
        <moos_var>SENSOR_DEPTH_DEPLOY</moos_var>
        <format>depth=%1%</format>
        <message_var>Deploy_Depth</message_var>
      </publish>
      <publish>
        <moos_var>DEPLOY_SPEED</moos_var>
        <format>speed=%1%</format>
        <message_var>Deploy_Speed</message_var>
      </publish>
      <publish>
        <moos_var>SENSOR_DEPTH_TRACKING</moos_var>
        <format>depth=%1%</format>
        <message_var>Deploy_Depth</message_var>
      </publish>
      <publish>
        <moos_var>SENSOR_DEPTH_ALTERNATE</moos_var>
        <format>depth=%1%</format>
        <message_var>Alternate_Depth</message_var>
      </publish>
      <publish>
        <moos_var>GPS_CONFIGURATION</moos_var>
        <format>period=%1%</format>
        <message_var>GPS_Interval</message_var>
      </publish>
      <publish>
        <moos_var>SENSOR_RACETRACK</moos_var>
        <format>points=%1%,%2%#heading=%3%#track_length=%4%#track_width=%5%#clockwise=%6%#speed=%7%</format>
        <message_var>Deploy_X</message_var>
        <message_var>Deploy_Y</message_var>
        <message_var>Survey_Heading</message_var>
        <message_var>Survey_Length</message_var>
        <message_var>Survey_Width</message_var>
        <message_var>Clockwise</message_var>
        <message_var>Deploy_Speed</message_var>
      </publish>
      <publish>
        <moos_var>SENSOR_YOYO</moos_var>
        <format>min_depth=%1%#max_depth=%2%</format>
        <message_var>Deploy_Depth</message_var>
        <message_var>Alternate_Depth</message_var>
      </publish>
      <publish>
        <moos_var>SMART_YOYO</moos_var>
        <format>min_depth=%1%#max_depth=%2%#period=%3%#period_segments=%4%</format>
        <message_var>Deploy_Depth</message_var>
        <message_var>Alternate_Depth</message_var>
        <message_var>Radius_Period</message_var>
        <message_var>Segments</message_var>
      </publish>
      <publish>
        <moos_var>SURVEY_HEADING</moos_var>
        <format>heading=%1%</format>
        <message_var>Survey_Heading</message_var>
      </publish>
      <publish>
        <moos_var>ZIGZAG_CONFIG</moos_var>
        <format>heading=%1%#period=%2%#amplitude=%3%#speed=%4%</format>
        <message_var>Survey_Heading</message_var>
        <message_var>Radius_Period</message_var>
        <message_var>Survey_Width</message_var>
        <message_var>Deploy_Speed</message_var>
      </publish>
      <publish>
        <moos_var>ZIGZAG_STATUS</moos_var>
        <format>points=zigzag:%1%,%2%,%3%,%4%,%5%,%6%</format>
        <message_var>Deploy_X</message_var>
        <message_var>Deploy_Y</message_var>
        <message_var>Survey_Heading</message_var>
        <message_var>Survey_Length</message_var>
        <message_var>Radius_Period</message_var>
        <message_var>Survey_Width</message_var>
      </publish>
      <publish>
        <moos_var>TRAIL_CONFIG</moos_var>
        <format>contact=%1%#trail_range=%2%#trail_angle=%3%#trail_angle_type=%4%</format>
        <message_var>Trail_Contact</message_var>
        <message_var>Trail_Range</message_var>
        <message_var>Trail_Angle</message_var>
        <message_var>Trail_Angle_Type</message_var>
      </publish>
      <publish>
        <moos_var>BISTATIC_CONFIG</moos_var>
        <format>desired_bistatic_angle=%1%#normal_speed=%2%</format>
        <message_var>Trail_Angle</message_var>
        <message_var>Deploy_Speed</message_var>
      </publish>

      <!-- Finally, set state variables -->
      <!-- these are for backward compatibility -->
      <publish>
        <moos_var>GOTO_SURFACE</moos_var>
        <format>FALSE</format>
      </publish>
      <publish>
        <moos_var>DEPLOY_MISSION</moos_var>
        <format>%1%</format>
        <message_var>Deploy_Mode</message_var>
      </publish>
      <publish>
        <moos_var>DEPTH_MODE</moos_var>
        <format>%1%</format>
        <message_var>Depth_Mode</message_var>
      </publish>
      <publish>
        <moos_var>DEPLOY_STATE</moos_var>
        <format>DEPLOY</format>
      </publish>
      <publish>
        <moos_var>MISSION_STATE</moos_var>
        <format>DEPLOY</format>
      </publish>
      <!-- end added in SWAMSI 09 -->
    </on_receipt>    
    <queuing>
      <ttl>300</ttl>
      <value_base>1000</value_base>
    </queuing>
  </message>
</message_set>
