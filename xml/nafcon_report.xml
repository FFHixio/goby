<?xml version="1.0" encoding="ASCII" standalone="yes"?>
<!-- contains nafcon (plus) contact and track
     for replacing pFramer (but still need pNaFCon) --> 
<message_set>
  <message>
    <name>SENSOR_CONTACT</name>
    <trigger>publish</trigger> 
    <trigger_moos_var mandatory_content="MessageType=SENSOR_CONTACT">
      PLUSNET_MESSAGES
    </trigger_moos_var>
    <size>32</size>
    <header>
      <id>13</id>
      <time>
        <name>ContactTimestamp</name>
      </time>
      <src_id>
        <name>SourcePlatformId</name>
      </src_id>
      <dest_id>
        <name>DestinationPlatformId</name>
      </dest_id>
    </header>
    <layout>
      <static>
        <name>MessageType</name>
        <value>SENSOR_CONTACT</value>
      </static>
      <static>
        <name>SensorReportType</name>
        <value>1</value>
      </static>
      <float algorithm="angle_0_360">
        <name>SensorHeading</name>
        <max>360</max>
        <min>0</min>
        <precision>0</precision>
      </float>
      <float>
        <name>SensorPitch</name>
        <max>90</max>
        <min>-90</min>
        <precision>0</precision>
      </float>
      <float>
        <name>SensorRoll</name>
        <max>180</max>
        <min>-180</min>
        <precision>0</precision>
      </float>
      <float>
        <name>SensorLatitude</name>
        <precision>5</precision>
        <max>90</max>
        <min>-90</min>
      </float>
      <float>
        <name>SensorLongitude</name>
        <precision>5</precision>
        <max>180</max>
        <min>-180</min>
      </float>
      <int>
        <name>SensorDepth</name>
        <max>1022</max>
        <min>0</min>
      </int>
      <int>
        <name>SensorCEP</name>
        <max>1022</max>
        <min>0</min>
      </int>
      <float>
        <name>ContactBearing</name>
        <max>360</max>
        <min>0</min>
        <precision>1</precision>
      </float>
      <float>
        <name>ContactBearingUncertainty</name>
        <max>10</max>
        <min>0</min>
        <precision>1</precision>
      </float>
      <float>
        <name>ContactBearingRate</name>
        <max>10</max>
        <min>-10</min>
        <precision>1</precision>
      </float>
      <float>
        <name>ContactBearingRateUncertainty</name>
        <max>3.1</max>
        <min>0</min>
        <precision>1</precision>
      </float>
      <float>
        <name>ContactElevation</name>
        <max>90</max>
        <min>-90</min>
        <precision>1</precision>
      </float>
      <float>
        <name>ContactElevationUncertainty</name>
        <max>10</max>
        <min>0</min>
        <precision>0</precision>
      </float>
      <int>
        <name>ContactSpectralLevel1</name>
        <max>127</max>
        <min>0</min>
      </int>
      <int>
        <name>ContactFrequency1</name>
        <max>4095</max>
        <min>0</min>
      </int>
      <int>
        <name>ContactBandwidth1</name>
        <max>20</max>
        <min>0</min>
      </int>
      <int>
        <name>ContactSpectralLevel2</name>
        <max>127</max>
        <min>0</min>
      </int>
      <int>
        <name>ContactFrequency2</name>
        <max>4095</max>
        <min>0</min>
      </int>
      <int>
        <name>ContactBandwidth2</name>
        <max>20</max>
        <min>0</min>
      </int>
    </layout>
    <!-- decoding -->
    <on_receipt>    
      <publish>
        <moos_var>NAFCON_MESSAGES</moos_var>
        <all />
      </publish>
      <!-- start pTransponderAIS replacement -->    
      <publish>
        <moos_var>AIS_REPORT</moos_var>
        <format>NAME=%1%,TYPE=%2%,UTC_TIME=%3$.0lf,X=%4%,Y=%5%,LAT=%6$lf,LON=%7$lf,SPD=,HDG=%8%,DEPTH=%9%</format>
        <message_var algorithm="modem_id2name,to_lower">SourcePlatformId</message_var>
        <message_var algorithm="modem_id2type,to_lower">SourcePlatformId</message_var>
        <message_var>ContactTimestamp</message_var>
        <message_var algorithm="lon2utm_x:SensorLatitude">SensorLongitude</message_var>
        <message_var algorithm="lat2utm_y:SensorLongitude">SensorLatitude</message_var>
        <message_var>SensorLatitude</message_var>
        <message_var>SensorLongitude</message_var>
        <message_var>SensorHeading</message_var>
        <message_var>SensorDepth</message_var>
      </publish>
      <publish>
        <moos_var type="double">%1%_NAV_UTC</moos_var>
        <format>%2$lf</format>
        <message_var algorithm="modem_id2name,to_upper">SourcePlatformId</message_var>
        <message_var>ContactTimestamp</message_var>
      </publish>
      <publish>
        <moos_var type="double">%1%_NAV_X</moos_var>
        <format>%2%</format>
        <message_var algorithm="modem_id2name,to_upper">SourcePlatformId</message_var>
        <message_var algorithm="lon2utm_x:SensorLatitude">SensorLongitude</message_var>
      </publish>
      <publish>
        <moos_var type="double">%1%_NAV_Y</moos_var>
        <format>%2%</format>
        <message_var algorithm="modem_id2name,to_upper">SourcePlatformId</message_var>
        <message_var algorithm="lat2utm_y:SensorLongitude">SensorLatitude</message_var>
      </publish>
      <publish>
        <moos_var type="double">%1%_NAV_LAT</moos_var>
        <format>%2%</format>
        <message_var algorithm="modem_id2name,to_upper">SourcePlatformId</message_var>
        <message_var>SensorLatitude</message_var>
      </publish>
      <publish>
        <moos_var type="double">%1%_NAV_LONG</moos_var>
        <format>%2$lf</format>
        <message_var algorithm="modem_id2name,to_upper">SourcePlatformId</message_var>
        <message_var>SensorLongitude</message_var>
      </publish>
      <publish>
        <moos_var type="double">%1%_NAV_HEADING</moos_var>
        <format>%2%</format>
        <message_var algorithm="modem_id2name,to_upper">SourcePlatformId</message_var>
        <message_var>SensorHeading</message_var>
      </publish>
      <publish>
        <moos_var type="double">%1%_NAV_DEPTH</moos_var>
        <format>%2%</format>
        <message_var algorithm="modem_id2name,to_upper">SourcePlatformId</message_var>
        <message_var>SensorDepth</message_var>
      </publish>
    </on_receipt>    
    <queuing>
      <ack>false</ack>
      <ttl>600</ttl>
      <value_base>2</value_base>
    </queuing>
    <!-- end pTransponderAIS replacement -->
  </message>
  <message>
    <name>SENSOR_TRACK</name>
    <trigger>publish</trigger> 
    <trigger_moos_var mandatory_content="MessageType=SENSOR_TRACK">
      PLUSNET_MESSAGES
    </trigger_moos_var>
    <size>32</size>
    <header>
      <id>14</id>
      <time>
        <name>TrackTimestamp</name>
      </time>
      <src_id>
        <name>SourcePlatformId</name>
      </src_id>
      <dest_id>
        <name>DestinationPlatformId</name>
      </dest_id>
    </header>
    <layout>
      <static>
        <name>MessageType</name>
        <value>SENSOR_TRACK</value>
      </static>
      <static>
        <name>SensorReportType</name>
        <value>2</value>
      </static>
      <int>
        <name>PlatformID</name>
        <max>31</max>
        <min>0</min>
      </int>
      <int>
        <name>TrackNumber</name>
        <max>255</max>
        <min>0</min>
      </int>
      <float>
        <name>TrackLatitude</name>
        <precision>5</precision>
        <max>90</max>
        <min>-90</min>
      </float>
      <float>
        <name>TrackLongitude</name>
        <precision>5</precision>
        <max>180</max>
        <min>-180</min>
      </float>
      <int>
        <name>TrackCEP</name>
        <max>1023</max>
        <min>0</min>
      </int>
      <int>
        <name>TrackDepth</name>
        <max>1023</max>
        <min>0</min>
      </int>
      <int>
        <name>TrackDepthUncertainty</name>
        <max>63</max>
        <min>0</min>
      </int>
      <float algorithm="angle_0_360">
        <name>TrackHeading</name>
        <max>360</max>
        <min>0</min>
        <precision>1</precision>
      </float>
      <float>
        <name>TrackHeadingUncertainty</name>
        <max>10</max>
        <min>0</min>
        <precision>1</precision>
      </float>
      <float>
        <name>TrackSpeed</name>
        <max>12.8</max>
        <min>0</min>
        <precision>1</precision>
      </float>
      <float>
        <name>TrackSpeedUncertainty</name>
        <max>3</max>
        <min>0</min>
        <precision>1</precision>
      </float>
      <int>
        <name>DepthClassification</name>
        <max>7</max>
        <min>0</min>  
      </int>
      <int>
        <name>TrackClassification</name>
        <max>7</max>
        <min>0</min>  
      </int>
      <int>
        <name>TrackSpectralLevel1</name>
        <max>127</max>
        <min>0</min>
      </int>
      <int>
        <name>TrackFrequency1</name>
        <max>4095</max>
        <min>0</min>
      </int>
      <int>
        <name>TrackBandwidth1</name>
        <max>20</max>
        <min>0</min>
      </int>
      <int>
        <name>TrackSpectralLevel2</name>
        <max>127</max>
        <min>0</min>
      </int>
      <int>
        <name>TrackFrequency2</name>
        <max>4095</max>
        <min>0</min>
      </int>
      <int>
        <name>TrackBandwidth2</name>
        <max>20</max>
        <min>0</min>
      </int>
    </layout>
    <!-- decoding -->
    <on_receipt>        
      <publish>
        <moos_var>NAFCON_MESSAGES</moos_var>
        <all />
      </publish>
      <!-- start pTransponderAIS replacement -->    
      <publish>
        <moos_var>AIS_REPORT</moos_var>
        <format>NAME=TRK_%1%_%2%,TYPE=track,UTC_TIME=%3$.0lf,X=%4%,Y=%5%,LAT=%6$lf,LON=%7$lf,SPD=%8%,HDG=%9%,DEPTH=%10%</format>
        <message_var>TrackNumber</message_var>
        <message_var algorithm="modem_id2name,to_lower">SourcePlatformId</message_var>
        <message_var>TrackTimestamp</message_var>
        <message_var algorithm="lon2utm_x:TrackLatitude">TrackLongitude</message_var>
        <message_var algorithm="lat2utm_y:TrackLongitude">TrackLatitude</message_var>
        <message_var>TrackLatitude</message_var>
        <message_var>TrackLongitude</message_var>
        <message_var>TrackSpeed</message_var>
        <message_var>TrackHeading</message_var>
        <message_var>TrackDepth</message_var>
      </publish>
      <publish>
        <moos_var type="double">TRK_%1%_%2%_NAV_UTC</moos_var>
        <format>%3$lf</format>
        <message_var>TrackNumber</message_var>
        <message_var algorithm="modem_id2name,to_upper">SourcePlatformId</message_var>
        <message_var>TrackTimestamp</message_var>
      </publish>
      <publish>
        <moos_var type="double">TRK_%1%_%2%_NAV_X</moos_var>
        <format>%3%</format>
        <message_var>TrackNumber</message_var>
        <message_var algorithm="modem_id2name,to_upper">SourcePlatformId</message_var>
        <message_var algorithm="lon2utm_x:TrackLatitude">TrackLongitude</message_var>
      </publish>
      <publish>
        <moos_var type="double">TRK_%1%_%2%_NAV_Y</moos_var>
        <format>%3%</format>
        <message_var>TrackNumber</message_var>
        <message_var algorithm="modem_id2name,to_upper">SourcePlatformId</message_var>
        <message_var algorithm="lat2utm_y:TrackLongitude">TrackLatitude</message_var>
      </publish>
      <publish>
        <moos_var type="double">TRK_%1%_%2%_NAV_LAT</moos_var>
        <format>%3$lf</format>
        <message_var>TrackNumber</message_var>
        <message_var algorithm="modem_id2name,to_upper">SourcePlatformId</message_var>
        <message_var>TrackLatitude</message_var>
      </publish>
      <publish>
        <moos_var type="double">TRK_%1%_%2%_NAV_LONG</moos_var>
        <format>%3$lf</format>
        <message_var>TrackNumber</message_var>
        <message_var algorithm="modem_id2name,to_upper">SourcePlatformId</message_var>
        <message_var>TrackLongitude</message_var>
      </publish>
      <publish>
        <moos_var type="double">TRK_%1%_%2%_NAV_SPEED</moos_var>
        <format>%3%</format>
        <message_var>TrackNumber</message_var>
        <message_var algorithm="modem_id2name,to_upper">SourcePlatformId</message_var>
        <message_var>TrackSpeed</message_var>
      </publish>
      <publish>
        <moos_var type="double">TRK_%1%_%2%_NAV_HEADING</moos_var>
        <format>%3%</format>
        <message_var>TrackNumber</message_var>
        <message_var algorithm="modem_id2name,to_upper">SourcePlatformId</message_var>
        <message_var>TrackHeading</message_var>
      </publish>
      <publish>
        <moos_var type="double">TRK_%1%_%2%_NAV_DEPTH</moos_var>
        <format>%3%</format>
        <message_var>TrackNumber</message_var>
        <message_var algorithm="modem_id2name,to_upper">SourcePlatformId</message_var>
        <message_var>TrackDepth</message_var>
      </publish>
    </on_receipt>        
    <queuing>
      <ack>false</ack>
      <ttl>600</ttl>
      <value_base>4</value_base>
    </queuing>
    <!-- end pTransponderAIS replacement -->
  </message>
</message_set>
