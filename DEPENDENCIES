#!/bin/bash
set -e -u
# ~~~~~~~~~~~~~~~~~~~~~~~
# third-party dependencies
# ~~~~~~~~~~~~~~~~~~~~~~~~

# LINUX
# This script will attempt to install packages using `apt-get` for
# Debian (and derivatives)
# 
# Most other distributions will have the appropriate
# package as well; it's up to you to find out what it is.
# if you don't know what a package is or does,
# search for it on http://packages.ubuntu.com/
# and you should be able to find the analog for your system
# if that fails, you can always download and compile from source
#
# if you need to compile boost from source, I recommend
# the boost-cmake distribution rather than the official
# bjam distribution. See https://svn.boost.org/trac/boost/wiki/CMake

# build-essential: gcc, c++ library, etc.
# cmake: Cross Platform Make: http://www.cmake.org/
# boost: header-only libraries in boost: http://www.boost.org/
# boost-*: compiled libraries in boost: http://www.boost.org
# xerces: Apache XML parser: http://xerces.apache.org/xerces-c/
# crypto++: Cryptography: http://www.cryptopp.com/
# protobuf: Google Protocol Buffers: http://code.google.com/p/protobuf/

# OpenSuSe Notes
# zypper install -t pattern devel_C_C++
# zypper install cmake
# zypper install boost-devel
# zypper install libxerces-c-devel
# (crypto++ from src)
# zypper install protobuf-devel
# zypper install cdk-devel

# MAC OS X
# Use MacPorts to install the needed dependencies. You will have 
# to install Wt from source to /opt/local 
# I believe these are the ports necessary to compile moos-ivp,
# moos-ivp-local, and goby:
# 
# boost +universal
# cmake
# jpeg +universal
# libcryptopp +universal
# ncurses +universal
# ncursesw
# protobuf-cpp
# socat
# tiff +universal
# xercesc
# zlib +universal

# Windows
# Goby does not currently build on Windows

if [[ $UID -ne 0 ]]; then
    printf "You must run this script as root. Use 'sudo' in Ubuntu. \n" 1>&2
    exit 1
fi

red="\33[1;31m"
nc="\33[1;0m"
green="\33[1;32m"

debian_base_packages=\
"build-essential 
cmake"

debian_boost_packages=\
"libboost-dev
libboost-system-dev
libboost-date-time-dev
libboost-thread-dev
libboost-program-options-dev
libboost-signals-dev
libboost-filesystem-dev"

debian_xerces_package=\
"libxerces-c-dev"

debian_other_packages=\
"libcrypto++-dev
libncurses-dev
libprotobuf-dev
protobuf-compiler
libcdk5-dev"


# Ubuntu
if [[ -e "`which add-apt-repository`" && ! "`lsb_release -sc`" = "lucid" ]]; then
    echo "adding ppa:goby-dev/ppa for Ubuntu Dependencies"
    add-apt-repository ppa:goby-dev/ppa
    apt-get update
    apt-get build-dep libgoby1-dev
    apt-get -y install $debian_base_packages
# Debian
elif [ -e "`which apt-get`" ]; then
    if [ -z "`apt-cache search ${debian_xerces_package}`" ]; then
        debian_xerces_package="libxerces-c2-dev"
    fi 
    
    apt-get -y install $debian_base_packages || printf $red"Could not install base packages\n"$nc
    apt-get -y install $debian_boost_packages || printf $red"Could not install boost packages: see http://www.boost.org/\n"$nc
    apt-get -y install $debian_xerces_package || printf $red"Could not install xerces package\n"$nc
    apt-get -y install $debian_other_packages || printf $red"Could not install some packages: read the top of this file (DEPENDENCIES)\n"$nc
fi 


#redhat_packages=\
#""
